<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Waka Multimedia - Home</title>

<style>
body, html {
  margin: 0;
  font-family: Arial, sans-serif;
  background: url('okay.png') no-repeat center center fixed;
  background-size: cover;
  color: white;
  overflow-x: hidden;
}

/* Navigation */
nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 40px;
  background: rgba(0,0,0,0.3);
  backdrop-filter: blur(10px);
}

nav h1 {
  font-size: 1.8em;
}

.nav-links button {
  margin-left: 15px;
  padding: 8px 15px;
  border-radius: 25px;
  border: none;
  background: rgba(29,185,84,0.8);
  color: white;
  font-weight: bold;
  cursor: pointer;
}

.nav-links button:hover {
  background: rgba(29,185,84,1);
}

/* Hero */
.hero {
  text-align: center;
  padding: 60px 20px 40px;
}

.hero h2 {
  font-size: 3em;
  margin-bottom: 20px;
}

.hero input {
  width: 500px;
  max-width: 90%;
  padding: 12px 15px;
  border-radius: 25px;
  border: none;
  background: white;
  color: black;
  text-align: center;
}

/* Featured */
.featuredSection {
  display: flex;
  gap: 25px;
  padding: 40px;
  justify-content: center;
  flex-wrap: wrap;
}

.featuredCard {
  width: 300px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  padding: 20px;
  text-align: center;
}

.featuredCard img {
  width: 100%;
  height: 200px;
  border-radius: 10px;
  object-fit: cover;
}

.cardButtons {
  margin-top: 10px;
  display: flex;
  justify-content: center;
  gap: 10px;
}

.cardButtons button {
  padding: 6px 10px;
  border-radius: 15px;
  border: none;
  background: rgba(29,185,84,0.9);
  color: white;
  cursor: pointer;
}

/* PLAYER BAR */
.playerBar {
  position: fixed;
  bottom: 0;
  width: 100%;
  background: rgba(0,0,0,0.85);
  padding: 15px;
  display: none;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.controls {
  display: flex;
  gap: 20px;
  align-items: center;
}

.controls button {
  padding: 8px 15px;
  border-radius: 20px;
  border: none;
  background: rgba(29,185,84,0.9);
  color: white;
  cursor: pointer;
}

.progress-container {
  width: 80%;
  height: 6px;
  background: rgba(255,255,255,0.3);
  border-radius: 5px;
  cursor: pointer;
}

.progress {
  height: 100%;
  width: 0%;
  background: #1db954;
  border-radius: 5px;
}

.volume {
  width: 150px;
}
</style>
</head>

<body>

<nav>
  <h1>Waka Multimedia</h1>
  <div class="nav-links">
    <button onclick="location.href='home.html'">Home</button>
    <button onclick="location.href='Discover.html'">Discover</button>
    <button onclick="location.href='portfolio.html'">PortFolio</button>
    <button onclick="location.href='upload.html'">Upload</button>
    <button onclick="location.href='login.html'">Login</button>
    <button onclick="location.href='register.html'">Register</button>
  </div>
</nav>

<div class="hero">
  <h2>Welcome to Waka Multimedia</h2>
  <p>Discover, upload and enjoy music like never before!</p>
  <input type="text" placeholder="Search music...">
</div>

<div class="featuredSection" id="featuredSection"></div>

<footer style="text-align:center;">
  &copy; 2026 Waka Multimedia <br>
  published by: Leonard Lestern
</footer>

<!-- PLAYER -->
<div class="playerBar" id="playerBar">
  <div id="nowPlaying"></div>

  <div class="progress-container" id="progressContainer">
    <div class="progress" id="progress"></div>
  </div>

  <div class="controls">
    <button onclick="prevTrack()">‚èÆ</button>
    <button id="playPauseBtn">‚ñ∂</button>
    <button onclick="nextTrack()">‚è≠</button>
    <input type="range" min="0" max="1" step="0.1" value="1" id="volumeSlider" class="volume">
  </div>
</div>

<script>
const audio = new Audio();
let playlist = [];
let current = 0;

const playerBar = document.getElementById("playerBar");
const playPauseBtn = document.getElementById("playPauseBtn");
const progress = document.getElementById("progress");
const progressContainer = document.getElementById("progressContainer");
const volumeSlider = document.getElementById("volumeSlider");
const featuredSection = document.getElementById("featuredSection");
const nowPlaying = document.getElementById("nowPlaying");

/* FETCH SONGS (LIMIT 10) */
async function fetchSongs(){
  try{
    const response = await fetch("http://localhost:3000/api/songs");
    const data = await response.json();
    playlist = data.slice(0,10);
    renderSongs();
  }catch(err){
    console.error(err);
  }
}

function renderSongs(){
  featuredSection.innerHTML = "";

  if(playlist.length === 0){
    const emptyCard = document.createElement("div");
    emptyCard.className = "featuredCard";
    emptyCard.innerHTML = `
      <h3>No Music Uploaded Yet üéµ</h3>
      <p>Be the first to upload music on Waka Multimedia.</p>
    `;
    featuredSection.appendChild(emptyCard);
    return;
  }

  playlist.forEach((song,index)=>{
    const card = document.createElement("div");
    card.className = "featuredCard";

    card.innerHTML = `
      <img src="${song.cover}">
      <h3>${song.title}</h3>
      <p><strong>Artist:</strong> ${song.artist}</p>

      <div class="cardButtons">
        <button onclick="playSong(${index})">‚ñ∂ Play</button>
        <a href="${song.src}" download>
          <button>‚¨á Download</button>
        </a>
        <button onclick="shareSong('${song.title}')">üîó Share</button>
      </div>
    `;

    featuredSection.appendChild(card);
  });
}

function playSong(index){
  current = index;
  audio.src = playlist[current].src;
  nowPlaying.textContent =
    playlist[current].title + " - " + playlist[current].artist;
  audio.play();
  playerBar.style.display = "flex";
  playPauseBtn.textContent = "‚è∏";
}

playPauseBtn.addEventListener("click", ()=>{
  if(audio.paused){
    audio.play();
    playPauseBtn.textContent = "‚è∏";
  } else {
    audio.pause();
    playPauseBtn.textContent = "‚ñ∂";
  }
});

function nextTrack(){
  current = (current+1)%playlist.length;
  playSong(current);
}

function prevTrack(){
  current = (current-1+playlist.length)%playlist.length;
  playSong(current);
}

/* AUTO PLAY NEXT */
audio.addEventListener("ended", ()=>{
  nextTrack();
});

/* PROGRESS */
audio.addEventListener("timeupdate", ()=>{
  if(audio.duration){
    const percent = (audio.currentTime/audio.duration)*100;
    progress.style.width = percent+"%";
  }
});

progressContainer.addEventListener("click",(e)=>{
  const width = progressContainer.clientWidth;
  const clickX = e.offsetX;
  audio.currentTime = (clickX/width)*audio.duration;
});

/* VOLUME */
volumeSlider.addEventListener("input", ()=>{
  audio.volume = volumeSlider.value;
});
audio.volume = volumeSlider.value;

/* SHARE */
function shareSong(title){
  if(navigator.share){
    navigator.share({
      title: title,
      text: "Listen to " + title + " on Waka Multimedia"
    });
  } else {
    alert("Sharing not supported on this device.");
  }
}

fetchSongs();
</script>

</body>
</html>